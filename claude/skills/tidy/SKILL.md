---
description: コミット前に適用。互換性維持のためだけの古い記述や不要なコードを検出し、ベストプラクティスに基づいたクリーンな実装を提案する。
---

# コードクリーンアップチェック

実装者のバイアスを排除するため、サブエージェントに委譲して第三者視点でレビューする。

## 実行手順

1. 今回のセッションで変更したファイルパスを把握する
2. Task ツールで `general-purpose` サブエージェントを起動し、変更ファイルパスを含めて以下のプロンプトを渡す:

```
コードクリーンアップの観点からレビューしてください。
実装の経緯は考慮せず、今のコードだけを見て判断してください。

## 変更ファイル
{変更したファイルパスの一覧}

## 変更内容の把握方法
`git diff --cached` と `git diff` を実行してください。
diff が空の場合は `git log -1 --format="" --name-only` で直近コミットの変更ファイルを確認し、`git diff HEAD~1` で差分を取得してください。

## レビュー観点

### 設計の妥当性
> トップエンジニアが今日、一から設計したとしても同じ設計にするか？
「いいえ」なら、クリーンな設計を提案する。

### ボーイスカウトルール
編集されたファイルとその周辺で以下を確認:
- 型の厳密化（`any` → 適切な型）
- 不要な変数・インポートの削除
- 命名の改善
- 早期リターンへの変換
- マジックナンバーの定数化
- 互換性維持のためだけの古い記述の削除

### 追加の確認観点
- `// TODO: remove after migration` 等のコメントが付いた古いコード
- 後方互換のためだけの型エイリアス・ラッパー・re-export・`@deprecated`
- 使われていないフィーチャーフラグ
- 過去の制約に基づいた回避策や workaround

### 別タスクとして提案する項目（直接修正しない）
アーキテクチャや実行フローに影響を与えるもの:
- `callback → async/await` への変換
- lodash → ネイティブメソッドへの置き換え
- 複数ファイルにまたがる大規模な統合

## 出力形式
- 修正すべき箇所: ファイルパス・行番号・修正内容を具体的に
- 別タスク提案: 概要のみ
- 問題なしの場合: 「問題なし」とだけ回答
```

3. サブエージェントの結果に基づき、修正を適用する
4. 修正した箇所を簡潔に報告する

## 関連スキル

コードクリーンアップ後、ドキュメント更新が必要な場合は `/docs` を実行する。
